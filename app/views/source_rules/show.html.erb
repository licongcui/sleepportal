<% @title = "Source Rule: #{@source_rule.name}" %>
<div class="page-header">
  <h1>
    <%= link_to @source_rule.source.name, @source_rule.source %> &raquo;<%= @title %>
    <% if @source.user_has_action?(current_user, "edit data source rules") %>
      <%= link_to "Edit Source Rule", edit_source_rule_path(@source_rule, source_id: @source.id), class: 'btn btn-mini' %>
      <%= link_to "Delete Source Rule", source_rule_path(@source_rule, source_id: @source.id), data: { confirm: "Are you sure you want to delete Source Rule #{@source_rule.name}?" }, method: :delete, class: 'btn btn-mini btn-danger' %>
    <% end %>
    <%= link_to "View Source Rules", source_rules_path(source_id: @source.id), class: 'btn btn-mini' %>
  </h1>
</div>

<dl class="dl-horizontal">
  <dt>Description</dt>
  <dd><%= simple_format @source_rule.description %></dd>

  <dt>Actions</dt>
  <dd>
    <table class="blank" style="width:100%"><col width="33%"/><col width="33%"/><col width="33%"/>
      <tr>
        <% SourceRule::ACTION_GROUPS.each_with_index do |(rule_group, rules), index| %>
          <td style="vertical-align:top">
            <%= check_box_tag rule_group, '1', false, disabled: true, class: "rule_group_#{index}_parent" %> <b><%= rule_group %></b><br />
            <% rules.each do |rule| %>
              &nbsp;&nbsp;<%= check_box_tag "rules[#{rule.gsub(' ', '_')}]", '1', @source_rule.has_action?(rule), disabled: true, class: "rule_group_#{index}" %> <%= rule %><br />
            <% end %>
          </td>
          <%= javascript_tag "toggleCheckboxGroupParent(#{index});" %>
        <% end %>
      </tr>
    </table>
  </dd>

  <dt>Users</dt>
  <dd>
    <ul>
      <% @source_rule.users.collect{|id| User.find_by_id(id)}.compact.each do |user| %>
        <li><%= link_to user.name, user %> &lsaquo;<%= user.email %>&rsaquo;</li>
      <% end %>
    </ul>
  </dd>

  <dt>Blocked</dt>
  <dd><%= @source_rule.blocked %></dd>

</dl>
