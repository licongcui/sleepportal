<%# If editing below update datasets.js.erb and reports.js.erb also... perhaps put all in javascript partial? %>

<% if false %>
  $("#popup").css({
    "width": "816px" //"408px"
  });
  $("#popup_title").html("<%= escape_javascript(image_tag('contour/open.png', align: 'absmiddle', alt: '')) %> <%= escape_javascript(@report.name) %>")
  $("#popup_content").html("<div id='popup_content_left'>Left</div><div id='popup_content_right' style='width:412px'></div><div style='clear:both'></div>");

  $("#popup_content_left").html("<%= escape_javascript(render("concepts/folder_search") + '<div id="concept_folders">'.html_safe + render("concepts/folders") + '</div>'.html_safe) %>");
  $("#popup_content_right").html("<%= escape_javascript(render("report_concepts/accordion")) %>");

  $("#popup_content_right").css({
    "overflow-y": "hidden",
    "width": "412px"
  })

  $(document.body).qtip('hide');loadPopup();
  centerPopup();

  $('#concept_search').watermark('Enter concept name or navigate folders.');
  $('#accordion').accordion({ fillSpace: true });
<% end %>

$("#inlaid_report").html("<%= escape_javascript(render("reports/edit")) %>");

<% unless @report.is_dataset? %>
  $('#report_table_form').submit();
<% end %>

$(function(){
  return $("#report_concept_search_term").on("keydown", function(event) {
    if (event.keyCode === $.ui.keyCode.TAB && $(this).data("catcomplete").menu.active) {
      return event.preventDefault();
    }
  }).catcomplete({
    source: root_url + ("concepts?autocomplete=true&" + (($('#report_concept_search_form').attr('action') || '?').split('?')[1])),
    html: true,
    select: function(event, ui) {
      return $("#selected_report_concept_id").val(ui.item ? ui.item.id : '');
    },
    close: function(event, ui) {
      $("#report_concept_search_form").submit();
      return $("#selected_report_concept_id").val('');
    }
  });
});
